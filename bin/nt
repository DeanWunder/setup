#!/bin/bash

# Check argument exists
if [ -z "$1" ]; then
    echo "Usage: $0 <branch>"
    exit 1
fi

# Check validity of the branch name
echo $1 | grep -e "BAI-" -e "BID-" -e "CTS-" -e "DLP-" -e "LIN-" -e "PRIM-" -e "TFNSW-" -e "SWCON2-" -e "SWDEL2-" -e "WAT-" > /dev/null
valid=$?
if [ $valid -eq 1 ]; then
    echo "Error: invalid branch name"
    exit 1
fi

dir=`pwd`

for project in bai bidfood cts dlp linbeck prime rms swconnect swdeliveryv2 watertight; do
    cd $HOME/git/$project && git stash > /dev/null && gsw master > /dev/null
done

cd $dir && git stash > /dev/null && gsw "$1"
cb
b:u &> /dev/null &
